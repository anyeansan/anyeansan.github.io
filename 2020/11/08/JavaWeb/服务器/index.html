<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/anyeansan.github.io/images/an-apple-180.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/anyeansan.github.io/images/an-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/anyeansan.github.io/images/an-16.png">
  <link rel="mask-icon" href="/anyeansan.github.io/images/an.svg" color="#222">
  <link rel="alternate" href="/anyeansan.github.io/atom.xml" title="安₃" type="application/atom+xml">

<link rel="stylesheet" href="/anyeansan.github.io/css/main.css">


<link rel="stylesheet" href="/anyeansan.github.io/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/anyeansan.github.io/',
    scheme: 'Gemini',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"left","display":"hide","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="一 概述1.1 服务器分类   类型 作用 例    WEB 服务器 HTTP Server 解析静态资源 apache, nginx, ...   应用服务器 Application Server 解析静态资源和动态资源 tomcat, jetty, weblogic, ...   1.2 前后端分离1 Servlet Servlet 即负责业务逻辑又负责页面展示 Servlet 页面展示要多痛">
<meta property="og:type" content="article">
<meta property="og:title" content="服务器">
<meta property="og:url" content="https:&#x2F;&#x2F;anyeansan.github.io&#x2F;2020&#x2F;11&#x2F;08&#x2F;JavaWeb&#x2F;%E6%9C%8D%E5%8A%A1%E5%99%A8&#x2F;">
<meta property="og:site_name" content="安₃">
<meta property="og:description" content="一 概述1.1 服务器分类   类型 作用 例    WEB 服务器 HTTP Server 解析静态资源 apache, nginx, ...   应用服务器 Application Server 解析静态资源和动态资源 tomcat, jetty, weblogic, ...   1.2 前后端分离1 Servlet Servlet 即负责业务逻辑又负责页面展示 Servlet 页面展示要多痛">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-11-08T12:53:37.734Z">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://anyeansan.github.io/2020/11/08/JavaWeb/%E6%9C%8D%E5%8A%A1%E5%99%A8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>服务器 | 安₃</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/anyeansan.github.io/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">安₃</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">我未成名君未嫁 可能俱是不如人</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/anyeansan.github.io/" rel="section"><i class="fa fa-fw fa-home"></i>安府</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/anyeansan.github.io/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>琅嬛福地</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/anyeansan.github.io/categories/" rel="section"><i class="fa fa-fw fa-th"></i>门派</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/anyeansan" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://anyeansan.github.io/anyeansan.github.io/2020/11/08/JavaWeb/%E6%9C%8D%E5%8A%A1%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/anyeansan.github.io/images/an3.png">
      <meta itemprop="name" content="安₃">
      <meta itemprop="description" content="一蓑烟雨任平生">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="安₃">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          服务器
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">✦</span>
              

              <time title="创建时间：2020-11-08 20:51:29 / 修改时间：20:53:37" itemprop="dateCreated datePublished" datetime="2020-11-08T20:51:29+08:00">2020-11-08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">☛</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/anyeansan.github.io/categories/CS/" itemprop="url" rel="index">
                    <span itemprop="name">CS</span>
                  </a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/anyeansan.github.io/categories/CS/JavaWeb/" itemprop="url" rel="index">
                    <span itemprop="name">JavaWeb</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="一-概述"><a href="#一-概述" class="headerlink" title="一 概述"></a>一 概述</h1><h2 id="1-1-服务器分类"><a href="#1-1-服务器分类" class="headerlink" title="1.1 服务器分类"></a>1.1 服务器分类</h2><table>
<thead>
<tr>
<th>类型</th>
<th>作用</th>
<th>例</th>
</tr>
</thead>
<tbody><tr>
<td>WEB 服务器 <code>HTTP Server</code></td>
<td>解析静态资源</td>
<td><code>apache, nginx, ...</code></td>
</tr>
<tr>
<td>应用服务器 <code>Application Server</code></td>
<td>解析静态资源和动态资源</td>
<td><code>tomcat, jetty, weblogic, ...</code></td>
</tr>
</tbody></table>
<h2 id="1-2-前后端分离"><a href="#1-2-前后端分离" class="headerlink" title="1.2 前后端分离"></a>1.2 前后端分离</h2><h3 id="1-Servlet"><a href="#1-Servlet" class="headerlink" title="1 Servlet"></a>1 Servlet</h3><ol>
<li><code>Servlet</code> 即负责业务逻辑又负责页面展示</li>
<li><code>Servlet</code> 页面展示要多痛苦有多痛苦：通过代码将数据和 <code>HTML</code> 响应给客户端</li>
</ol>
<h3 id="2-JSP"><a href="#2-JSP" class="headerlink" title="2 JSP"></a>2 JSP</h3><ol>
<li><code>JSP</code> 即负责业务逻辑又负责页面展示</li>
<li><code>JSP</code> 即能写 java 代码又能使用标签，但会造成 <code>JSP</code> 庞大而混乱</li>
</ol>
<h3 id="3-Servlet-JSP"><a href="#3-Servlet-JSP" class="headerlink" title="3 Servlet + JSP"></a>3 Servlet + JSP</h3><ol>
<li><code>Servlet</code> 负责业务逻辑，<code>JSP</code> 负责页面展示 </li>
<li><code>Servlet</code> 将响应数据存在域对象中，<code>JSP</code> 也是 <code>Servlet</code> ，可以从域中获取响应数据</li>
<li>问题：<ol>
<li><code>JSP</code> 要获取数据还是要在 <code>&lt;% %&gt;</code>  中写 java 代码，于是出现了 <code>EL 表达式</code> 用于获取数据</li>
<li>一些复杂的展示逻辑如循环，判断，也需要在 <code>&lt;% %&gt;</code>  中写 java 代码，于是出现了 <code>JSTL</code> 用于页面展示逻辑</li>
</ol>
</li>
<li>最终就是 <code>Servlet + JSP + EL + JSTL</code></li>
</ol>
<h3 id="4-Servlet-HTML-AJAX-JSON-JS"><a href="#4-Servlet-HTML-AJAX-JSON-JS" class="headerlink" title="4 Servlet + HTML + AJAX + JSON + JS"></a>4 Servlet + HTML + AJAX + JSON + JS</h3><ol>
<li><code>Servlet</code> 负责业务逻辑</li>
<li><code>AJAX</code> 负责请求动态数据，通常是 <code>JSON</code></li>
<li><code>JS</code> 负责 DOM，展示 <code>HTML</code></li>
</ol>
<h2 id="1-3-动静分离"><a href="#1-3-动静分离" class="headerlink" title="1.3 动静分离"></a>1.3 动静分离</h2><ol>
<li>静态资源部署在 <code>nginx</code> 服务器上，动态资源部署在 <code>tomcat</code> 应用服务器上</li>
<li>如果请求静态资源，则直接请求 <code>nginx</code></li>
<li>如果请求动态资源，则 <code>nginx</code> 利用 <strong>反向代理</strong> 将请求交给 <code>tomcat</code></li>
</ol>
<h1 id="二-JavaWeb项目"><a href="#二-JavaWeb项目" class="headerlink" title="二 JavaWeb项目"></a>二 JavaWeb项目</h1><h2 id="2-1-标准目录结构"><a href="#2-1-标准目录结构" class="headerlink" title="2.1 标准目录结构"></a>2.1 标准目录结构</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">部署项目名</span><br><span class="line">	资源文件（html、js、css、img ...）</span><br><span class="line">	WEB-INF</span><br><span class="line">		classes</span><br><span class="line">		lib</span><br><span class="line">		web.xml</span><br></pre></td></tr></table></figure>

<h2 id="2-2-源代码目录结构"><a href="#2-2-源代码目录结构" class="headerlink" title="2.2 源代码目录结构"></a>2.2 源代码目录结构</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 IDEA</span></span><br><span class="line">开发项目名</span><br><span class="line">    src</span><br><span class="line">    web</span><br><span class="line">        WEB-INF</span><br><span class="line">            classes</span><br><span class="line">            lib</span><br><span class="line">            web.xml</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 Eclipse</span></span><br><span class="line">开发项目名</span><br><span class="line">    src</span><br><span class="line">    WebContent</span><br><span class="line">        WEB-INF</span><br><span class="line">            classes</span><br><span class="line">            lib</span><br><span class="line">            web.xml</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 3 MyEclipse</span></span><br><span class="line">开发项目名</span><br><span class="line">    src</span><br><span class="line">    WebRoot    </span><br><span class="line">        WEB-INF</span><br><span class="line">            classes</span><br><span class="line">            lib</span><br><span class="line">            web.xml</span><br></pre></td></tr></table></figure>

<ol>
<li><code>src</code> 目录下的文件，编译后放在  <code>/WEB-INF/classes</code> 下</li>
<li><code>web/WebContent/WebRoot</code> 就相当于标准目录结构</li>
</ol>
<h1 id="二-Tomcat"><a href="#二-Tomcat" class="headerlink" title="二 Tomcat"></a>二 Tomcat</h1><h2 id="2-1-概述"><a href="#2-1-概述" class="headerlink" title="2.1 概述"></a>2.1 概述</h2><ol>
<li>服务器接收客户端请求封装 <code>HttpServletRequest</code> 对象，并传递给 web 应用</li>
<li>web 应用处理请求</li>
<li>服务器将处理结果封装到 <code>HttpServletResponse</code> 对象，响应给客户端</li>
</ol>
<h2 id="2-2-Tomcat-目录结构"><a href="#2-2-Tomcat-目录结构" class="headerlink" title="2.2 Tomcat 目录结构"></a>2.2 Tomcat 目录结构</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">├── bin</span><br><span class="line">│   ├── startup.sh </span><br><span class="line">│   ├── shutdown.sh</span><br><span class="line">│   ├── catalina.sh # Tomcat核心管理脚本</span><br><span class="line">│   └── version.sh # Tomcat版本信息脚本</span><br><span class="line">├── conf </span><br><span class="line">│   ├── Catalina</span><br><span class="line">│   ├── context.xml</span><br><span class="line">│   ├── server.xml</span><br><span class="line">│   ├── web.xml</span><br><span class="line">│   └── tomcat-users.xml # Tomcat管理用户配置文件</span><br><span class="line">├── logs</span><br><span class="line">│   ├── catalina.out # 启动信息日志</span><br><span class="line">│   └── localhost_access_log.2020-03-25.txt # 访问日志</span><br><span class="line">├── lib # 存放web应用能访问的JAR包</span><br><span class="line">├── webapps # Web应用程序根目录</span><br><span class="line">└── work # 编译目录</span><br></pre></td></tr></table></figure>

<ol>
<li><code>bin</code> 和 <code>lib</code> 目录可以被多个 Tomcat 实例共用</li>
<li><code>conf</code>、<code>logs</code>、<code>temp</code>、<code>webapps</code> 和 <code>work</code> 目录每个 Tomcat 实例必须拥有自己独立的一份</li>
</ol>
<h2 id="2-3-Tomcat-管理"><a href="#2-3-Tomcat-管理" class="headerlink" title="2.3 Tomcat 管理"></a>2.3 Tomcat 管理</h2><h3 id="1-概述"><a href="#1-概述" class="headerlink" title="1 概述"></a>1 概述</h3><ol>
<li>Tomcat 管理功能用于对 Tomcat 自身以及部署在 Tomcat 的应用进行管理</li>
<li>测试用，生产环境禁用（默认禁止）</li>
<li>开启管理功能需要配置管理用户</li>
</ol>
<h3 id="2-配置管理用户"><a href="#2-配置管理用户" class="headerlink" title="2 配置管理用户"></a>2 配置管理用户</h3><ul>
<li><code>basedir/conf/tomcat-users.xml</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;tomcat-users xmlns=&quot;http://tomcat.apache.org/xml&quot;</span><br><span class="line">              xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">              xsi:schemaLocation=&quot;http://tomcat.apache.org/xml tomcat-users.xsd&quot;</span><br><span class="line">              version=&quot;1.0&quot;&gt;</span><br><span class="line"># 配置角色</span><br><span class="line">&lt;role rolename=&quot;manager-gui&quot;/&gt;</span><br><span class="line">&lt;role rolename=&quot;admin-gui&quot;/&gt;</span><br><span class="line">&lt;role rolename=&quot;host-gui&quot;/&gt;</span><br><span class="line"># 配置用户和密码并分配角色</span><br><span class="line">&lt;user username=&quot;&quot; password=&quot;&quot; roles=&quot;manager-gui,admin-gui,host-gui&quot;/&gt;</span><br><span class="line">&lt;/tomcat-users&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3-允许访问"><a href="#3-允许访问" class="headerlink" title="3 允许访问"></a>3 允许访问</h3><ul>
<li><code>basedir/webapps/[host-]manager/META-INF/context.xml</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Context antiResourceLocking=&quot;false&quot; privileged=&quot;true&quot; &gt;</span><br><span class="line">	# allow：允许指定 ip 和 端口</span><br><span class="line">	&lt;Valve className=&quot;org.apache.catalina.valves.RemoteAddrValve&quot;</span><br><span class="line">         allow=&quot;127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1&quot; /&gt;</span><br><span class="line">&lt;/Context&gt;</span><br></pre></td></tr></table></figure>

<h2 id="2-4-配置文件"><a href="#2-4-配置文件" class="headerlink" title="2.4 配置文件"></a>2.4 配置文件</h2><h3 id="1-web-xml"><a href="#1-web-xml" class="headerlink" title="1 web.xml"></a>1 <code>web.xml</code></h3><ol>
<li>Web 应用程序描述文件，都是关于是 Web 应用程序的配置文件</li>
<li>所有 Web 应用的 <code>web.xml</code> 文件的父文件</li>
</ol>
<h3 id="2-context-xml"><a href="#2-context-xml" class="headerlink" title="2 context.xml"></a>2 <code>context.xml</code></h3><ol>
<li>Tomcat 公用的环境配置，tomcat 服务器会定时去扫描这个文件</li>
<li>一旦发现文件被修改（时间戳改变了），就会自动重新加载这个文件，而不需要重启服务器</li>
</ol>
<h3 id="3-server-xml"><a href="#3-server-xml" class="headerlink" title="3 server.xml"></a>3 <code>server.xml</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;Server port=&quot;8005&quot; shutdown=&quot;SHUTDOWN&quot;&gt;</span><br><span class="line">	&lt;Service name=&quot;Catalina&quot;&gt;</span><br><span class="line">		&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot; connectionTimeout=&quot;20000&quot; redirectPort=&quot;8443&quot; /&gt;</span><br><span class="line">		&lt;Connector port=&quot;8009&quot; protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot; /&gt;</span><br><span class="line">		&lt;Engine name=&quot;Catalina&quot; defaultHost=&quot;localhost&quot;&gt;</span><br><span class="line">			&lt;Host name=&quot;localhost&quot;  appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;</span><br><span class="line">				&lt;Context/&gt;</span><br><span class="line">			&lt;/Host&gt;</span><br><span class="line">		&lt;/Engine&gt;</span><br><span class="line">	&lt;/Service&gt;</span><br><span class="line">&lt;/Server&gt;</span><br></pre></td></tr></table></figure>

<h4 id="1-lt-Server-gt"><a href="#1-lt-Server-gt" class="headerlink" title="1 &lt;Server&gt;"></a>1 <code>&lt;Server&gt;</code></h4><ol>
<li><p>顶层元素，表示一个运行于JVM中的 tomcat 实例</p>
</li>
<li><p>一个 Server 可以有多个 Service</p>
</li>
<li><p><code>&lt;Server port=&quot;8005&quot; shutdown=&quot;SHUTDOWN&quot;&gt;</code></p>
<ul>
<li><p><code>port</code>：表示接收 shutdown 指令的端口号</p>
</li>
<li><p><code>shutdonw</code>：表示关闭此 Server 的指令</p>
</li>
</ul>
</li>
</ol>
<h4 id="2-lt-Service-gt"><a href="#2-lt-Service-gt" class="headerlink" title="2 &lt;Service&gt;"></a>2 <code>&lt;Service&gt;</code></h4><ol>
<li>将连接器 Connector 关联至引擎 Engine</li>
<li>一个 Service 可以有多个 Connector，但只能有一个 Engine</li>
</ol>
<h4 id="3-lt-Connector-gt"><a href="#3-lt-Connector-gt" class="headerlink" title="3 &lt;Connector&gt;"></a>3 <code>&lt;Connector&gt;</code></h4><ol>
<li><p>用于从客户端接收请求，之后将请求分配给引擎进行处理</p>
</li>
<li><p>HTTP 协议</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot; connectionTimeout=&quot;20000&quot; redirectPort=&quot;8443&quot; /&gt;</span><br></pre></td></tr></table></figure>

<ol>
<li>表示客户端可以通过 8080 端口使用 HTTP 协议访问 tomcat</li>
<li><code>connectionTimeout</code>：超时时间</li>
<li><code>redirectPort</code>：表示当强制要求 https 而请求却是 http 时，重定向至端口号为 8443 的 Connector</li>
</ol>
</li>
<li><p>AJP协议</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port=&quot;8009&quot; protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot; /&gt;</span><br></pre></td></tr></table></figure>

<ol>
<li>表示客户端可以通过 8009 端口使用 AJP 协议访问 tomcat</li>
<li>AJP 协议负责和其他的 Http 服务器（如Apache）建立连接，在把 Tomcat 与其他服务器集成时，就需要用到这个连接器（动静分离）</li>
</ol>
</li>
</ol>
<h4 id="4-lt-Engine-gt"><a href="#4-lt-Engine-gt" class="headerlink" title="4 &lt;Engine&gt;"></a>4 <code>&lt;Engine&gt;</code></h4><ol>
<li>用于从一个或多个 Connector 中接收请求，然后转至对应的虚拟主机 Host 处理请求，并将响应返回给 Connector，最终传递给客户端</li>
<li>一个 Engine 中可以有多个 Host</li>
<li><code>&lt;Engine name=&quot;Catalina&quot; defaultHost=&quot;localhost&quot;&gt;</code><ul>
<li><code>name</code><ul>
<li>用于日志和错误信息，在整个 Server 中应该是唯一的</li>
</ul>
</li>
<li><code>defaultHost</code><ul>
<li>当发往本机的请求指定的 host 不存在时，一律使用 defaultHost 指定的 host 进行处理</li>
<li>因此，defaultHost 的值，必须与 Engine 中的一个 Host 组件的 name 属性值匹配</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="5-lt-Host-gt"><a href="#5-lt-Host-gt" class="headerlink" title="5 &lt;Host&gt;"></a>5 <code>&lt;Host&gt;</code></h4><ol>
<li>一个 Host 组件代表 Engine 中的一个虚拟主机</li>
<li>一个 Host 可以有多个 Context </li>
<li><code>&lt;Host name=&quot;localhost&quot;  appBase=&quot;webapps&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;</code><ul>
<li><code>name</code><ul>
<li>虚拟主机的主机名</li>
<li>一个 Engine 有且只有一个 Host 组件的 name 属性和 Engine 的 defaultHost 属性相匹配</li>
</ul>
</li>
<li><code>appBase</code><ul>
<li>Web 应用默认所在目录</li>
</ul>
</li>
<li><code>unpackWARS</code><ul>
<li>是否将代表 Web 应用的 WAR 文件解压</li>
<li><code>true</code><ul>
<li>通过解压后的文件结构运行该Web应用</li>
</ul>
</li>
<li><code>false</code><ul>
<li>直接使用WAR文件运行Web应用</li>
</ul>
</li>
</ul>
</li>
<li><code>autoDeploy</code><ul>
<li>是否自动部署</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="6-lt-Context-gt"><a href="#6-lt-Context-gt" class="headerlink" title="6 &lt;Context&gt;"></a>6 <code>&lt;Context&gt;</code></h4><ol>
<li>一个 Context 代表在虚拟主机上运行的一个Web应用</li>
<li><code>&lt;Context docBase=&quot;&quot; path=&quot;&quot; reloadable=&quot;&quot;/&gt;</code><ul>
<li><code>docBase</code><ol>
<li>指定了该Web应用使用的WAR包路径或应用目录</li>
<li>自动部署时<ol>
<li>如果 <code>docBase</code> 指定的WAR包或应用目录就在 <code>appBase</code> 中，不要指定 <code>docBase</code></li>
<li>否则，需要指定 <code>docBase</code></li>
</ol>
</li>
</ol>
</li>
<li><code>path</code><ol>
<li>指定了访问该Web应用的上下文路径，会与请求URI进行匹配</li>
<li><code>path=&quot;&quot;</code> 表示这个 Context 是虚拟主机的默认 Web 应用，当请求的URI与所有的path都不匹配时，使用该默认Web应用来处理</li>
<li>自动部署时<ol>
<li>如果没有XML配置文件且应用不在 <code>appBase</code> 下，则需要配置 <code>path</code></li>
<li>否则，不需配置 <code>path</code>，而是根据配置文件名、WAR文件名或应用目录名推导而出，例：<ol>
<li><code>xmlBase/test.xml</code> 则 <code>path=&quot;test&quot;</code></li>
<li><code>appBase/test.WAR</code> 则 <code>path=&quot;test&quot;</code></li>
<li><code>appBase/test/</code> 则 <code>path=&quot;test&quot;</code></li>
<li>如果上述文件名为 <code>ROOT</code> 则 <code>path=&quot;&quot;</code> </li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li><code>reloadable</code><ul>
<li>指示 tomcat 是否在运行时监控 <code>WEB-INF/classes</code> 和 <code>WEB-INF/lib</code> 目录下变动</li>
<li><code>true</code><ul>
<li>当有变动时，会触发 Web 应用的重新加载</li>
<li>开发环境下，方便调试</li>
</ul>
</li>
<li><code>false</code><ul>
<li>默认，因为在生产环境中设置为 true 会给服务器带来性能压力</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="2-5-Tomcat-请求流程"><a href="#2-5-Tomcat-请求流程" class="headerlink" title="2.5 Tomcat 请求流程"></a>2.5 Tomcat 请求流程</h2><ol>
<li>请求此 Server </li>
<li>根据 Connector 配置协议和端口号选定 Service 和 Engine</li>
<li>根据域名和 IP 选定 Host</li>
<li>根据 URI 选定 Context/Web应用</li>
</ol>
<h2 id="2-6-Tomcat-部署应用"><a href="#2-6-Tomcat-部署应用" class="headerlink" title="2.6 Tomcat 部署应用"></a>2.6 Tomcat 部署应用</h2><h3 id="1-部署形式"><a href="#1-部署形式" class="headerlink" title="1 部署形式"></a>1 部署形式</h3><ol>
<li>应用目录</li>
<li>WAR包</li>
</ol>
<h3 id="2-部署方式"><a href="#2-部署方式" class="headerlink" title="2 部署方式"></a>2 部署方式</h3><h4 id="1-静态部署"><a href="#1-静态部署" class="headerlink" title="1 静态部署"></a>1 静态部署</h4><ol>
<li>在 <code>server.xml</code> 中通过 <code>&lt;context&gt;</code> 元素静态部署Web应用</li>
<li>不推荐静态部署，因为 <code>server.xml</code> 是不可动态重加载的资源，服务器一旦启动，要修改这个文件，就得重启服务器才能重新加载。</li>
<li>自动部署可以在 Tomcat 运行时通过定期的扫描来实现重新部署应用，不需要重启服务器</li>
</ol>
<h4 id="2-自动部署"><a href="#2-自动部署" class="headerlink" title="2 自动部署"></a>2 自动部署</h4><h5 id="1-开启自动部署"><a href="#1-开启自动部署" class="headerlink" title="1 开启自动部署"></a>1 开启自动部署</h5><ol>
<li>要开启自动部署，需要配置所在的虚拟主机，即 <code>server.xml</code> 中的 <code>&lt;Host&gt;</code></li>
<li><code>&lt;Host xmlBase=&quot;&quot; appBase=&quot;&quot; autoDeploy=&quot;true&quot; deployOnStartup=&quot;true&quot;</code><ul>
<li><code>xmlBase</code><ul>
<li>指定Web应用的XML配置文件所在的目录，默认值 <code>basedir/conf/&lt;engine_name&gt;/&lt;host_name&gt;</code></li>
</ul>
</li>
<li><code>appBase</code><ul>
<li>指定Web应用所在的目录，默认值 <code>webapps</code></li>
</ul>
</li>
<li><code>autoDeploy=&quot;true&quot;</code><ul>
<li>表示 Tomcat 在运行时定期检查新的Web应用或Web应用的更新</li>
</ul>
</li>
<li><code>deployOnStartup=&quot;true&quot;</code><ul>
<li>表示 Tomcat 在启动时检查Web应用，且将所有检测到的Web应用视作新应用</li>
</ul>
</li>
</ul>
</li>
<li>开启自动部署之后，通过检查 <code>xmlBase</code> 和 <code>appBase</code> 指定的目录是否有新的或更新的应用来实现自动部署，检查顺序<ol>
<li><code>xmlBase</code> 下的 XML 配置文件</li>
<li><code>appBase</code> 下的 WAR 文件</li>
<li><code>appBase</code> 下的应用目录</li>
</ol>
</li>
</ol>
<h5 id="2-自动部署实现方式"><a href="#2-自动部署实现方式" class="headerlink" title="2 自动部署实现方式"></a>2 自动部署实现方式</h5><ol>
<li>WAR 文件或应用目录直接添加到 tomcat 的 <code>appBase</code> 指定的目录下</li>
<li>WAR 文件或应用目录在别处，通过在 <code>basedir/conf/server.xml</code> 中配置 <code>Conctext</code> 指明应用路径<ul>
<li>由于要配置 <code>server.xml</code> ，所以重新部署需要重启</li>
</ul>
</li>
<li>WAR 文件或应用目录在别处，通过配置 <code>xmlBase</code> 下的 XML 配置文件指明应用路径<ul>
<li>重新部署不需要重启</li>
</ul>
</li>
</ol>
<h5 id="3-IDE-的自动部署"><a href="#3-IDE-的自动部署" class="headerlink" title="3 IDE 的自动部署"></a>3 IDE 的自动部署</h5><h6 id="1-MyEclipse"><a href="#1-MyEclipse" class="headerlink" title="1 MyEclipse"></a>1 MyEclipse</h6><ol>
<li>MyEclipse 使用方式一</li>
<li>直接将 WAR 文件或应用目录复制到 <code>basedir/webapps</code> 下</li>
<li>因为应用就在 <code>appBase</code> 中，所以不需要配置 <code>Context</code></li>
</ol>
<h6 id="2-Eclipse"><a href="#2-Eclipse" class="headerlink" title="2 Eclipse"></a>2 Eclipse</h6><ol>
<li><p>Eclipse 使用方式二</p>
</li>
<li><p>Eclipse 本质是在其 <code>workspace</code> 下映射了一个 tomcat 的镜像，每创建一个 tomcat，就生成文件名为 <code>tmp编号</code> 的 tomcat 镜像，Eclipse 通过这个镜像 tomcat 运行应用</p>
</li>
<li><p><code>Catalina_Base</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>basedir/conf/server.xml</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Host&gt;</span><br><span class="line">	&lt;Context docBase=&quot;应用的真实路径&quot; path=&quot;网络访问的虚拟路径名(自定义)&quot; /&gt;</span><br><span class="line">&lt;/Host&gt;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h6 id="3-Intellij"><a href="#3-Intellij" class="headerlink" title="3 Intellij"></a>3 Intellij</h6><ol>
<li><p>Intellij 使用方式三</p>
</li>
<li><p>Intellij 在 <code>configdir/system/tomcat/</code> 创建了新的 tomcat 实例</p>
</li>
<li><p>部署应用时，会在 tomcat 实例的 <code>conf/catalina/localhost</code> 目录下自动创建 XML 配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Context docBase=&quot;应用的真实路径&quot; path=&quot;与 XML 配置文件名相同，其实不用配置&quot;/&gt;</span><br></pre></td></tr></table></figure>

<ol>
<li>如果部署时指定了应用名，如 <code>/test</code>，则 XML 配置文件名称为 <code>test.xml</code>，<code>paht=&quot;test&quot;</code></li>
<li>如果部署时省略了应用名，即 <code>/</code>，则 XML 配置文件名称为 <code>ROOT.xml</code>，<code>paht=&quot;&quot;</code></li>
</ol>
</li>
</ol>
<h2 id="2-7-Tomcat-启动-amp-访问"><a href="#2-7-Tomcat-启动-amp-访问" class="headerlink" title="2.7 Tomcat 启动 &amp; 访问"></a>2.7 Tomcat 启动 &amp; 访问</h2><h3 id="1-概述-1"><a href="#1-概述-1" class="headerlink" title="1 概述"></a>1 概述</h3><h4 id="1-CATALINA-HOME"><a href="#1-CATALINA-HOME" class="headerlink" title="1 CATALINA_HOME"></a>1 <code>CATALINA_HOME</code></h4><ol>
<li>是 Tomcat 的安装目录</li>
<li>指向公用信息的位置，就是 <code>bin</code> 和 <code>lib</code> 目录的父目录</li>
</ol>
<h4 id="2-CATALINA-BASE"><a href="#2-CATALINA-BASE" class="headerlink" title="2 CATALINA_BASE"></a>2 <code>CATALINA_BASE</code></h4><ol>
<li>是 Tomcat 的工作目录</li>
<li>指向每个 Tomcat 目录私有信息的位置，即 <code>conf、logs、temp、webapps</code> 和 <code>work</code> 目录的父目录</li>
<li>一个 <code>CATALINA_BASE</code> 就代表一个 Tomcat 实例 </li>
<li>如果 <code>CATALINA_BASE</code> 没有值的话，则默认值就是 <code>CATALINA_HOME</code></li>
</ol>
<h3 id="2-启动"><a href="#2-启动" class="headerlink" title="2 启动"></a>2 启动</h3><ol>
<li>执行 <code>startup.bat</code> ，其实最终是执行 <code>catalina.bat</code> </li>
<li>Tomcat 启动时，需要查找 <code>CATALINA_HOME</code> 这个环境变量，并判断是否为空<ol>
<li><code>CATALINA_HOME</code>  不为空，则根据值查找 <code>bin/catalina.bat</code> ，找到就执行，找不到报错</li>
<li><code>CATALINA_HOME</code>  为空<ol>
<li>就将当前目录设为 <code>CATALINA_HOME</code> 的值，接着判断当前目录下是否存在 <code>bin/catalina.bat</code></li>
<li>如果不存在，将当前目录的父目录设为 <code>CATALINA_HOME</code> 的值，继续判断 <code>bin/catalina.bat</code>，一直循环</li>
<li>最后如果找到就执行，找不到就报错</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="3-访问"><a href="#3-访问" class="headerlink" title="3 访问"></a>3 访问</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ip:port/path/source</span><br></pre></td></tr></table></figure>

<ol>
<li><code>port</code> <ul>
<li>省略则访问 <code>80</code> 端口</li>
</ul>
</li>
<li><code>path</code> <ul>
<li>省略则访问 <code>ROOT</code></li>
</ul>
</li>
<li><code>source</code><ul>
<li>省略则访问首页</li>
</ul>
</li>
</ol>
<h1 id="三-Nginx"><a href="#三-Nginx" class="headerlink" title="三 Nginx"></a>三 Nginx</h1><h2 id="3-1-安装"><a href="#3-1-安装" class="headerlink" title="3.1 安装"></a>3.1 安装</h2><ol>
<li><p>配置官方yum源（官网查看）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/yum.repos.d/nginx.repo</span><br><span class="line"></span><br><span class="line">[nginx-stable]</span><br><span class="line">name=nginx stable repo</span><br><span class="line">baseurl=http://nginx.org/packages/centos/$releasever/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://nginx.org/keys/nginx_signing.key</span><br><span class="line">module_hotfixes=true</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install nginx -y</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="3-2-目录结构"><a href="#3-2-目录结构" class="headerlink" title="3.2 目录结构"></a>3.2 目录结构</h2><table>
<thead>
<tr>
<th>目录</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>/etc/logrotate.d/nginx</code></td>
<td>实现nginx日志切割</td>
</tr>
<tr>
<td><code>/etc/nginx</code></td>
<td>配置文件所在目录</td>
</tr>
<tr>
<td><code>/var/log/nginx</code></td>
<td>日志目录</td>
</tr>
<tr>
<td><code>var/cache/nginx</code></td>
<td>缓存目录</td>
</tr>
<tr>
<td><code>/usr/sbin/nginx</code></td>
<td>命令文件</td>
</tr>
<tr>
<td><code>/usr/sbin/nginx-debug</code></td>
<td>debug命令文件</td>
</tr>
<tr>
<td><code>/usr/share/nginx/html</code></td>
<td>默认站点目录（图片 音视频 附件… ）</td>
</tr>
</tbody></table>
<h2 id="3-3-配置文件"><a href="#3-3-配置文件" class="headerlink" title="3.3 配置文件"></a>3.3 配置文件</h2><h3 id="1-etc-nginx-nginx-conf（主配置文件）"><a href="#1-etc-nginx-nginx-conf（主配置文件）" class="headerlink" title="1 /etc/nginx/nginx.conf（主配置文件）"></a>1 <code>/etc/nginx/nginx.conf</code>（主配置文件）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">1 基本配置</span><br><span class="line">user  nginx;  # 定义 worker_process 的管理用户，所有请求都会映射成此用户</span><br><span class="line">worker_processes  1; # 定义有几个worder_process（建议=cpu核数）</span><br><span class="line">error_log  /var/log/nginx/error.log warn; # 定义错误日志路径信息</span><br><span class="line">pid        /var/run/nginx.pid; # 定义pid文件路径信息</span><br><span class="line">2 事件区域配置</span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024; # 1 个worker process可以同时接收1024访问请求</span><br><span class="line">&#125;</span><br><span class="line"># http区域配置</span><br><span class="line">http &#123;</span><br><span class="line">    include       /etc/nginx/mime.types; # 加载一个配置文件</span><br><span class="line">    default_type  application/octet-stream; # 指定默认识别文件类型</span><br><span class="line">    log_format  main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class="line">                      &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class="line">                      &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;  # 定义日志的格式</span><br><span class="line">    access_log  /var/log/nginx/access.log  main; # 指定日志路径（main 表示使用main定义的格式）</span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line">    keepalive_timeout  65; # 超时时间</span><br><span class="line">    #gzip  on;</span><br><span class="line">    include /etc/nginx/conf.d/*.conf; # 加载一个配置文件</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Nginx 有两个进程<ol>
<li><code>master process</code><ul>
<li>管理服务是否正常运行</li>
</ul>
</li>
<li><code>worker process</code><ul>
<li>处理用户的访问请求</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="2-etc-nginx-conf-d-default-conf（扩展配置-默认虚拟主机配置文件-）"><a href="#2-etc-nginx-conf-d-default-conf（扩展配置-默认虚拟主机配置文件-）" class="headerlink" title="2 /etc/nginx/conf.d/default.conf（扩展配置(默认虚拟主机配置文件)）"></a>2 <code>/etc/nginx/conf.d/default.conf</code>（扩展配置(默认虚拟主机配置文件)）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">4 server区域信息（配置一个网站，即一个虚拟主机）</span><br><span class="line">server &#123;</span><br><span class="line">    listen       80; # 监听端口</span><br><span class="line">    server_name  localhost; # 网站域名</span><br><span class="line">    location / &#123; # 表示匹配URI以 / 开头的请求</span><br><span class="line">        root   /usr/share/nginx/html; # 定义站点目录的位置</span><br><span class="line">        index  index.html index.htm; # 定义首页文件</span><br><span class="line">    &#125;</span><br><span class="line">    error_page   500 502 503 504  /50x.html; # 优雅显示错误页面信息</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-4-利用-Nginx-搭建网站"><a href="#3-4-利用-Nginx-搭建网站" class="headerlink" title="3.4 利用 Nginx 搭建网站"></a>3.4 利用 Nginx 搭建网站</h2><ol>
<li><p>创建虚拟主机配置文件 <code>/etc/nginx/conf.d/xxx.conf</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       8090;</span><br><span class="line">    server_name  www.iisfive.com;</span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">一个端口可配置多个域名 www、blog、bbs...</span><br></pre></td></tr></table></figure>
</li>
<li><p>网站代码文件</p>
</li>
<li><p>DNS 配置</p>
<ol>
<li>真实域名，在域名网站配置</li>
<li>模拟域名，在 Windows 的 hosts 文件配置</li>
</ol>
</li>
</ol>
<h2 id="3-5-虚拟主机访问方式"><a href="#3-5-虚拟主机访问方式" class="headerlink" title="3.5 虚拟主机访问方式"></a>3.5 虚拟主机访问方式</h2><ol>
<li>基于域名访问</li>
<li>基于地址访问<ul>
<li>服务器可能有多个IP，在虚拟主机配置的server中指定只能访问指定地址 <code>listen ip:port</code></li>
</ul>
</li>
<li>基于端口访问</li>
</ol>
<h2 id="3-6-模块-Module"><a href="#3-6-模块-Module" class="headerlink" title="3.6 模块 Module"></a>3.6 模块 Module</h2><ol>
<li><code>ngx_http_access_module</code><ul>
<li>根据访问的服务器地址进行指定资源的控制</li>
</ul>
</li>
<li><code>ngx_http_auth_basic_module</code><ul>
<li>访问认证</li>
</ul>
</li>
<li><code>ngx_http_autoindex_module</code><ul>
<li>文件共享</li>
</ul>
</li>
<li><code>ngx_http_stub_status_module</code><ul>
<li>状态监控</li>
</ul>
</li>
<li><code>ngx_http_rewrite_module</code><ul>
<li>页面跳转</li>
</ul>
</li>
<li><code>ngx_http_upstream_module</code><ul>
<li>负载均衡</li>
</ul>
</li>
<li><code>ngx_http_proxy_module</code><ul>
<li>反向代理</li>
</ul>
</li>
<li><code>ngx_http_core_module</code><ul>
<li>核心模块</li>
<li>location<ol>
<li><code>location = /</code><ul>
<li>精确匹配</li>
</ul>
</li>
<li><code>location /</code><ul>
<li>默认匹配，没有匹配时匹配默认</li>
</ul>
</li>
<li><code>location = /test</code><ul>
<li>目录匹配</li>
</ul>
</li>
<li><code>location ^~ /text</code><ul>
<li>优先匹配</li>
</ul>
</li>
<li><code>location ~* \.jpg</code><ul>
<li>扩展名</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ol>
<h2 id="3-7-负载均衡"><a href="#3-7-负载均衡" class="headerlink" title="3.7 负载均衡"></a>3.7 负载均衡</h2><ol>
<li>集群<ul>
<li>完成相同任务的一组服务器</li>
</ul>
</li>
<li>负载均衡<ul>
<li>对用户访问请求进行调度分配，实现用户访问压力分担</li>
</ul>
</li>
<li>正向代理 &amp; 反向代理<ol>
<li>正向代理<ol>
<li>正向代理代理的对象是客户端</li>
<li>客户端明确知道要访问的目标服务器，但由于一些原因不能直接访问，则通过代理服务器来访问。</li>
<li>正向代理隐藏了真实的请求客户端，服务端不知道真实的客户端是谁，客户端请求的服务都被代理服务器代替来请求</li>
</ol>
</li>
<li>反向代理<ol>
<li>反向代理代理的对象是服务端</li>
<li>客户端请求代理服务器，代理服务器帮客户端把请求转发到真实的服务器那里去</li>
<li>反向代理隐藏了真实的服务端，可能有许多台服务器提供服务，客户端并不知道也不需要知道具体是哪一台服务器处理此次请求。</li>
</ol>
</li>
</ol>
</li>
</ol>

    </div>

    
    
    

    <div>
      
	<div>
    
        <div style="text-align:center;color: #66ccff;font-size:14px;">-------------The End&nbsp;&nbsp;<i class="fa fa-paw"></i>&nbsp;&nbsp;客官请自便-------------</div>
    
</div
      
    </div>

      <footer class="post-footer">


        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
                <a href="/anyeansan.github.io/2020/11/08/JavaWeb/JDBC/" rel="next" title="JDBC">
                  <i class="fa fa-chevron-left"></i> JDBC
                </a>
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
                <a href="/anyeansan.github.io/2020/11/08/JavaWeb/XML/" rel="prev" title="XML">
                  XML <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          秘笈
        </li>
        <li class="sidebar-nav-overview">
          安₃
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一-概述"><span class="nav-text">一 概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-服务器分类"><span class="nav-text">1.1 服务器分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-前后端分离"><span class="nav-text">1.2 前后端分离</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Servlet"><span class="nav-text">1 Servlet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-JSP"><span class="nav-text">2 JSP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Servlet-JSP"><span class="nav-text">3 Servlet + JSP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Servlet-HTML-AJAX-JSON-JS"><span class="nav-text">4 Servlet + HTML + AJAX + JSON + JS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-动静分离"><span class="nav-text">1.3 动静分离</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二-JavaWeb项目"><span class="nav-text">二 JavaWeb项目</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-标准目录结构"><span class="nav-text">2.1 标准目录结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-源代码目录结构"><span class="nav-text">2.2 源代码目录结构</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二-Tomcat"><span class="nav-text">二 Tomcat</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-概述"><span class="nav-text">2.1 概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-Tomcat-目录结构"><span class="nav-text">2.2 Tomcat 目录结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-Tomcat-管理"><span class="nav-text">2.3 Tomcat 管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-概述"><span class="nav-text">1 概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-配置管理用户"><span class="nav-text">2 配置管理用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-允许访问"><span class="nav-text">3 允许访问</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-配置文件"><span class="nav-text">2.4 配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-web-xml"><span class="nav-text">1 web.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-context-xml"><span class="nav-text">2 context.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-server-xml"><span class="nav-text">3 server.xml</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-lt-Server-gt"><span class="nav-text">1 &lt;Server&gt;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-lt-Service-gt"><span class="nav-text">2 &lt;Service&gt;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-lt-Connector-gt"><span class="nav-text">3 &lt;Connector&gt;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-lt-Engine-gt"><span class="nav-text">4 &lt;Engine&gt;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-lt-Host-gt"><span class="nav-text">5 &lt;Host&gt;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-lt-Context-gt"><span class="nav-text">6 &lt;Context&gt;</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-Tomcat-请求流程"><span class="nav-text">2.5 Tomcat 请求流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-6-Tomcat-部署应用"><span class="nav-text">2.6 Tomcat 部署应用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-部署形式"><span class="nav-text">1 部署形式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-部署方式"><span class="nav-text">2 部署方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-静态部署"><span class="nav-text">1 静态部署</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-自动部署"><span class="nav-text">2 自动部署</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-开启自动部署"><span class="nav-text">1 开启自动部署</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-自动部署实现方式"><span class="nav-text">2 自动部署实现方式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-IDE-的自动部署"><span class="nav-text">3 IDE 的自动部署</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-MyEclipse"><span class="nav-text">1 MyEclipse</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-Eclipse"><span class="nav-text">2 Eclipse</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-Intellij"><span class="nav-text">3 Intellij</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-7-Tomcat-启动-amp-访问"><span class="nav-text">2.7 Tomcat 启动 &amp; 访问</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-概述-1"><span class="nav-text">1 概述</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-CATALINA-HOME"><span class="nav-text">1 CATALINA_HOME</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-CATALINA-BASE"><span class="nav-text">2 CATALINA_BASE</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-启动"><span class="nav-text">2 启动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-访问"><span class="nav-text">3 访问</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三-Nginx"><span class="nav-text">三 Nginx</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-安装"><span class="nav-text">3.1 安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-目录结构"><span class="nav-text">3.2 目录结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-配置文件"><span class="nav-text">3.3 配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-etc-nginx-nginx-conf（主配置文件）"><span class="nav-text">1 /etc/nginx/nginx.conf（主配置文件）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-etc-nginx-conf-d-default-conf（扩展配置-默认虚拟主机配置文件-）"><span class="nav-text">2 /etc/nginx/conf.d/default.conf（扩展配置(默认虚拟主机配置文件)）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-利用-Nginx-搭建网站"><span class="nav-text">3.4 利用 Nginx 搭建网站</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-虚拟主机访问方式"><span class="nav-text">3.5 虚拟主机访问方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6-模块-Module"><span class="nav-text">3.6 模块 Module</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-7-负载均衡"><span class="nav-text">3.7 负载均衡</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="安₃"
      src="/anyeansan.github.io/images/an3.png">
  <p class="site-author-name" itemprop="name">安₃</p>
  <div class="site-description" itemprop="description">一蓑烟雨任平生</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/anyeansan.github.io/archives/">
        
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">琅嬛福地</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/anyeansan.github.io/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">门派</span></a>
      </div>
  </nav>
</div>
  <div class="feed-link motion-element">
    <a href="/anyeansan.github.io/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-star-half-full"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">安₃</span>
</div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="/anyeansan.github.io/lib/anime.min.js"></script>
  <script src="/anyeansan.github.io/lib/velocity/velocity.min.js"></script>
  <script src="/anyeansan.github.io/lib/velocity/velocity.ui.min.js"></script>
<script src="/anyeansan.github.io/js/utils.js"></script><script src="/anyeansan.github.io/js/motion.js"></script>
<script src="/anyeansan.github.io/js/schemes/pisces.js"></script>
<script src="/anyeansan.github.io/js/next-boot.js"></script>



  




  <script src="/anyeansan.github.io/js/local-search.js"></script>













  

  

</body>
</html>
